<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{/layout/basic :: setContent(~{this::content})}">
    <th:block th:fragment="content">

        <div id="main-content">
            <div class="page-heading">
                <div class="page-title">
                    <div class="row">
                        <div class="col-12 col-md-6 order-md-1 order-last">
                            <h3>House Read Page</h3>
                        </div>
                    </div>
                </div>
                <section class="section">
                    <div class="card">
                        <div class="card-header">
                                <span><img class="wishIcon" th:src="@{/images/icons/heart_black.png}"
                                           th:data-current="black"
                                           style="width: 1.3em; height: 1.3em; float: right">
                                <label class="wishCount"
                                       style="float: right; padding-right: 0.5em;font-weight: bold "></label></span>

                        </div>
                        <div class="card-body">
                            <form class="form form-vertical" method="post">
                                <div class="form-body">
                                    <div class="row">
                                        <!--<th:block sec:authentication="name"></th:block>-->


                                        <input type="hidden" name="houseNum" th:value="${dto.houseNum}">
                                        <input type="hidden" name="page" th:value="${requestDTO.page}">
                                        <input type="hidden" name="type" th:value="${requestDTO.type}">
                                        <input type="hidden" name="keyword" th:value="${requestDTO.keyword}">

                                        <div class="col-9">
                                            <div class="form-group">
                                                <label style="font-weight: bold">제목</label>
                                                <input type="text" class="form-control" name="title"
                                                       th:value="${dto.title}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">작성자</label>
                                                <input type="text" class="form-control" name="id" th:value="${dto.id}"
                                                       readonly>
                                            </div>
                                        </div>

                                        <div class="col-1">
                                            <div class="form-group">
                                                <label style="font-weight: bold">조회</label>
                                                <input type="text" class="form-control" name="view"
                                                       th:value="${dto.view}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-8">
                                            <div class="form-group">
                                                <label style="font-weight: bold">주소</label>
                                                <input type="text" class="form-control" name="address" id="address"
                                                       th:value="${dto.address}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">상태</label>
                                                <input type="text" class="form-control" name="status"
                                                       th:value="${dto.status}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">면적</label>
                                                <input type="text" class="form-control" name="area"
                                                       th:value="${dto.area}" readonly>
                                            </div>
                                        </div>


                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">유형</label>
                                                <input class="form-control" name="contractType"
                                                       th:value="${dto.contractType}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">건물유형</label>
                                                <input class="form-control" name="contractType"
                                                       th:value="${dto.buildingType}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">중개수수료 (만원)</label>
                                                <input type="number" class="form-control" name="brokerage"
                                                       th:value="${dto.brokerage}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">최소 계약기간 (개월)</label>
                                                <input type="number" class="form-control" name="minTerm"
                                                       th:value="${dto.minTerm}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">해당 층 수</label>
                                                <input type="number" class="form-control" name="theFloor"
                                                       th:value="${dto.theFloor}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">전체 층 수</label>
                                                <input type="number" class="form-control" name="wholeFloor"
                                                       th:value="${dto.wholeFloor}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">입주 가능 날짜</label>
                                                <input type="text" id="moveInDate" class="form-control"
                                                       name="moveInDate" th:value="${dto.moveInDate}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">준공 날짜</label>
                                                <input type="text" id="completionDate" class="form-control"
                                                       name="completionDate" th:value="${dto.completionDate}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">방 개수</label>
                                                <input type="number" class="form-control" name="room"
                                                       th:value="${dto.structureDto.room}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">거실 개수</label>
                                                <input type="number" class="form-control" name="livingRoom"
                                                       th:value="${dto.structureDto.livingRoom}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">화장실 개수</label>
                                                <input type="number" class="form-control" name="toilet"
                                                       th:value="${dto.structureDto.toilet}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">베란다 개수</label>
                                                <input type="number" class="form-control" name="veranda"
                                                       th:value="${dto.structureDto.veranda}" readonly>
                                            </div>
                                        </div>


                                        <div class="col-2 price">
                                            <div class="form-group">
                                                <label style="font-weight: bold">가격 (만원)</label>
                                                <input type="number" class="form-control price" name="price"
                                                       th:value="${dto.priceDto.price}" readonly>
                                            </div>
                                        </div>


                                        <div class="col-2 deposit" style="display:none">
                                            <div class="form-group">
                                                <label style="font-weight: bold">보증금 (만원)</label>
                                                <input type="number" class="form-control deposit" name="deposit"
                                                       th:value="${dto.priceDto.deposit}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2 monthly" style="display:none">
                                            <div class="form-group">
                                                <label style="font-weight: bold">월세 (만원)</label>
                                                <input type="number" class="form-control monthly" name="monthly"
                                                       th:value="${dto.priceDto.monthly}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">관리비 (만원)</label>
                                                <input type="number" class="form-control" name="totalCost"
                                                       th:value="${dto.costDto.totalCost}" readonly>
                                            </div>
                                        </div>

                                        <div class="col-2">
                                            <div class="form-group">
                                                <label style="font-weight: bold">관리비 기타 항목</label>
                                                <input type="text" class="form-control" name="costContent"
                                                       th:value="${dto.costDto.costContent}" readonly>
                                            </div>
                                        </div>


                                        <div class="col-12">
                                            <label style="font-weight: bold">관리비 포함 항목</label>
                                        </div>

                                        <div class="col-12">
                                            <li class="d-inline-block me-2 mb-1">
                                                <div class="form-check">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                               class="form-check-input form-check-secondary form-check-glow"
                                                               name="electricity"
                                                               th:checked="${dto.costDto.electricity}" disabled>
                                                        <label class="form-check-label">전기세</label>
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="d-inline-block me-2 mb-1">
                                                <div class="form-check">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                               class="form-check-input form-check-secondary form-check-glow"
                                                               name="gas" th:checked="${dto.costDto.gas}" disabled>
                                                        <label class="form-check-label">가스비</label>
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="d-inline-block me-2 mb-1">
                                                <div class="form-check">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                               class="form-check-input form-check-secondary form-check-glow"
                                                               name="water" th:checked="${dto.costDto.water}" disabled>
                                                        <label class="form-check-label">수도세</label>
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="d-inline-block me-2 mb-1">
                                                <div class="form-check">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                               class="form-check-input form-check-secondary form-check-glow"
                                                               name="costTv" th:checked="${dto.costDto.costTv}"
                                                               disabled>
                                                        <label class="form-check-label">TV</label>
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="d-inline-block me-2 mb-1">
                                                <div class="form-check">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                               class="form-check-input form-check-secondary form-check-glow"
                                                               name="internet" th:checked="${dto.costDto.internet}"
                                                               disabled>
                                                        <label class="form-check-label">인터넷</label>
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="d-inline-block me-2 mb-1">
                                                <div class="form-check">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                               class="form-check-input form-check-secondary form-check-glow"
                                                               name="costParking"
                                                               th:checked="${dto.costDto.costParking}" disabled>
                                                        <label class="form-check-label">주차비</label>
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="d-inline-block me-2 mb-1">
                                                <div class="form-check">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                               class="form-check-input form-check-secondary form-check-glow"
                                                               name="etc" th:checked="${dto.costDto.etc}" disabled>
                                                        <label class="form-check-label">기타</label>
                                                    </div>
                                                </div>
                                            </li>
                                        </div>


                                        <div class="col-12">
                                            <label style="font-weight: bold">가능 여부</label>
                                        </div>

                                        <div class="col-12">
                                            <li class="d-inline-block me-2 mb-1">
                                                <div class="form-check">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                               class="form-check-input form-check-primary form-check-glow"
                                                               name="elevator" th:checked="${dto.elevator}" disabled>
                                                        <label class="form-check-label">엘레베이터</label>
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="d-inline-block me-2 mb-1">
                                                <div class="form-check">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                               class="form-check-input form-check-primary form-check-glow"
                                                               name="pet" th:checked="${dto.pet}" disabled>
                                                        <label class="form-check-label">애완동물</label>
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="d-inline-block me-2 mb-1">
                                                <div class="form-check">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                               class="form-check-input form-check-primary form-check-glow"
                                                               name="parking" th:checked="${dto.parking}" disabled>
                                                        <label class="form-check-label">주차</label>
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="d-inline-block me-2 mb-1">
                                                <div class="form-check">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox"
                                                               class="form-check-input form-check-primary form-check-glow"
                                                               name="loan" th:checked="${dto.loan}" disabled>
                                                        <label class="form-check-label">대출</label>
                                                    </div>
                                                </div>
                                            </li>
                                        </div>
                                    </div>


                                    <div class="col-12">
                                        <label style="font-weight: bold">옵션</label>
                                    </div>
                                    <div class="col-12">
                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="tv" th:checked="${dto.optionDto.tv}" disabled>
                                                    <label class="form-check-label">TV</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="airConditioner"
                                                           th:checked="${dto.optionDto.airConditioner}" disabled>
                                                    <label class="form-check-label">에어컨</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="refrigerator"
                                                           th:checked="${dto.optionDto.refrigerator}" disabled>
                                                    <label class="form-check-label">냉장고</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="washer" th:checked="${dto.optionDto.washer}" disabled>
                                                    <label class="form-check-label">세탁기</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="dryer" th:checked="${dto.optionDto.dryer}" disabled>
                                                    <label class="form-check-label">건조기</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="induction" th:checked="${dto.optionDto.induction}"
                                                           disabled>
                                                    <label class="form-check-label">인덕션</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="gasStove" th:checked="${dto.optionDto.gasStove}"
                                                           disabled>
                                                    <label class="form-check-label">가스레인지</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="sink" th:checked="${dto.optionDto.sink}" disabled>
                                                    <label class="form-check-label">싱크대</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="desk" th:checked="${dto.optionDto.desk}" disabled>
                                                    <label class="form-check-label">책상</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="bookshelf" th:checked="${dto.optionDto.bookshelf}"
                                                           disabled>
                                                    <label class="form-check-label">책장</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="bed" th:checked="${dto.optionDto.bed}" disabled>
                                                    <label class="form-check-label">침대</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="closet" th:checked="${dto.optionDto.closet}" disabled>
                                                    <label class="form-check-label">옷장</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="dishwasher" th:checked="${dto.optionDto.dishwasher}"
                                                           disabled>
                                                    <label class="form-check-label">식기세척기</label>
                                                </div>
                                            </div>
                                        </li>

                                        <li class="d-inline-block me-2 mb-1">
                                            <div class="form-check">
                                                <div class="custom-control custom-checkbox">
                                                    <input type="checkbox"
                                                           class="form-check-input form-check-secondary form-check-glow"
                                                           name="shoeRack" th:checked="${dto.optionDto.shoeRack}"
                                                           disabled>
                                                    <label class="form-check-label">신발장</label>
                                                </div>
                                            </div>
                                        </li>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-group custom-control">
                                            <div id="map" style="height: 300px; border-radius: 10px;">

                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-12">
                                        <div class="form-group fileForm custom-control">
                                            <label style="font-weight: bold">Image Files</label>
                                            <div class="custom-file-input-group">
                                                <div class="filepond--root multiple-files-filepond filepond--hopper custom-file-input-zone"
                                                     data-style-button-remove-item-position="left"
                                                     data-style-button-process-item-position="right"
                                                     data-style-load-indicator-position="right"
                                                     data-style-progress-indicator-position="right"
                                                     data-style-button-remove-item-align="false"
                                                     style="height: 250px; background-color: rgba(219, 219, 219, 0.3); border-radius: 10px; z-index: 1">


                                                    <div class="uploadResult" style="z-index: 2">
                                                        <ul>
                                                            <li th:each="houseImage : ${dto.imageDTOList}"
                                                                th:data-file="${houseImage.getThumbnailURL()}">
                                                                <img th:if="${houseImage.path != null}"
                                                                     th:src="|/display?fileName=${houseImage.getThumbnailURL()}|">
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="box">

                                            </div>
                                        </div>


                                        <div class="modal fade text-left imageModal" id="backdrop" tabindex="-1"
                                             aria-labelledby="myModalLabel4" style="display: none;" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable"
                                                 role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h4 class="modal-title" id="myModalLabel4">Picture
                                                        </h4>
                                                        <button type="button" class="close" data-bs-dismiss="modal"
                                                                aria-label="Close">
                                                            <i data-feather="x"></i>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">

                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button"
                                                                class="btn btn-light-secondary rounded-pill"
                                                                data-bs-dismiss="modal">
                                                            <i class="bx bx-x d-block d-sm-none"></i>
                                                            <span class="d-none d-sm-block">Close</span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                        <div class="col-12">
                                            <div class="form-floating">
                                            <textarea class="form-control" name="content"
                                                      style="margin-top: 1em; margin-bottom: 1em; height: 77px;"
                                                      readonly>[[${dto.content}]]</textarea>
                                                <label style="font-weight: bold">Comments</label>
                                            </div>
                                        </div>


                                        <div class="col-12 d-flex justify-content-between">
                                            <div class="reviewSet">
                                                <button type="button"
                                                        class="btn btn-outline-primary me-1 mb-1 rounded-pill addReviewBtn"
                                                        data-bs-toggle="modal" data-bs-target="#exampleModalCenter">
                                                    평가하기
                                                </button>
                                                <div class="modal fade reviewModal" id="exampleModalCenter"
                                                     tabindex="-1"
                                                     aria-labelledby="exampleModalCenterTitle"
                                                     style="display: none;"
                                                     aria-hidden="true">
                                                    <div class="modal-dialog modal-dialog-centered modal-dialog-centered modal-dialog-scrollable"
                                                         role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-header bg-primary">
                                                                <h5 class="modal-title" id="exampleModalCenterTitle"
                                                                    style="color:white">
                                                                    해당 집을 둘러본 후기를 남겨주세요.
                                                                </h5>
                                                                <button type="button" class="close"
                                                                        data-bs-dismiss="modal" aria-label="Close">
                                                                    <i data-feather="x"></i>
                                                                </button>
                                                            </div>


                                                            <div class="modal-body"
                                                                 th:if="${#authentication.principal.id} != null">
                                                                <div class="form-group">
                                                                    <label style="font-weight: bold">Reviewer
                                                                        ID</label>
                                                                    <input type="text" class="form-control"
                                                                           name="reviewerId"
                                                                           th:value="${#authentication.principal.id}"
                                                                           readonly>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label style="font-weight: bold">Grade<span
                                                                            class="grade"></span></label>
                                                                    <div class="starrr" style="z-index: 3"></div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <label style="font-weight: bold">Comment</label>
                                                                    <input type="text" class="form-control"
                                                                           name="content"
                                                                           placeholder="해당 매물 혹은 중개인에 대한 후기를 작성해주세요."
                                                                           value="리뷰 테스트">
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer justify-content-between">
                                                                <div>
                                                                    <button type="button"
                                                                            class="btn btn-danger ml-1 rounded-pill reviewRemoveBtn"
                                                                            data-bs-dismiss="modal">
                                                                        <i class="bx bx-check d-block d-sm-none"></i>
                                                                        <span class="d-none d-sm-block">Remove</span>
                                                                    </button>

                                                                    <button type="button"
                                                                            class="btn btn-warning ml-1 rounded-pill reviewModifyBtn"
                                                                            data-bs-dismiss="modal">
                                                                        <i class="bx bx-check d-block d-sm-none"></i>
                                                                        <span class="d-none d-sm-block">Modify</span>
                                                                    </button>

                                                                </div>
                                                                <div>
                                                                    <button type="button"
                                                                            class="btn btn-light-secondary rounded-pill"
                                                                            data-bs-dismiss="modal">
                                                                        <i class="bx bx-x d-block d-sm-none"></i>
                                                                        <span class="d-none d-sm-block">Close</span>
                                                                    </button>
                                                                    <button type="button"
                                                                            class="btn btn-primary ml-1 rounded-pill reviewSaveBtn"
                                                                            data-bs-dismiss="modal">
                                                                        <i class="bx bx-check d-block d-sm-none"></i>
                                                                        <span class="d-none d-sm-block">Accept</span>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>


                                            <div class="buttonSet">
                                                <a th:href="@{/house/remove?(houseNum=${dto.houseNum}, page=${requestDTO.page}, type=${requestDTO.type}, keyword=${requestDTO.keyword})}">
                                                    <button type="button" class="btn btn-danger me-1 mb-1 rounded-pill"
                                                            id="removeBtn">Remove
                                                    </button>
                                                </a>
                                                <a th:href="@{/house/modify?(houseNum=${dto.houseNum}, page=${requestDTO.page}, type=${requestDTO.type}, keyword=${requestDTO.keyword})}">
                                                    <button type="button" class="btn btn-warning me-1 mb-1 rounded-pill"
                                                            id="modifyBtn">Modify
                                                    </button>
                                                </a>
                                                <a th:href="@{/house/list?(page=${requestDTO.page}, type=${requestDTO.type}, keyword=${requestDTO.keyword})}">
                                                    <button type="button"
                                                            class="btn btn-secondary me-1 mb-1 rounded-pill"
                                                            id="listBtn">List
                                                    </button>
                                                </a>
                                            </div>
                                        </div>

                                        <div class="col-12">
                                            <div class="list-group reviewList">

                                            </div>
                                        </div>


                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </section>
            </div>
        </div>

    </th:block>
</th:block>

<script>

    $(document).ready(function () {

        var form = $(".form");
        var reviewModal = $(".reviewModal");
        var inputId = $('input[name="reviewerId"]');
        var inputContent = $('input[name="content"]');
        var houseNum = [[${dto.houseNum}]];
        var targetId = '[[${dto.id}]]';
        var reviewNum;
        var grade = 0;


        var mapContainer = document.getElementById('map'),
            mapOption = {
                center: new kakao.maps.LatLng(33.450701, 126.570667),
                level: 4
            };
        var map = new kakao.maps.Map(mapContainer, mapOption);
        var geocoder = new kakao.maps.services.Geocoder();

        geocoder.addressSearch($("#address").val(), function (result, status) {

            if (status === kakao.maps.services.Status.OK) {

                // 보안 문제로 본 주소를 그대로 노출하지 않고, 본 주소를 포함하는 랜덤한 길이의 원으로 위치 표시
                // 본 주소에서 랜덤한 길이의 반지름을 가지는 원 생성
                var random = Math.floor(Math.random() * 100) + 30;
                console.log("default random R : ", random);
                var beforeCoords = new kakao.maps.LatLng(result[0].y, result[0].x);

                // 랜덤 좌표를 구할 때, -1할지 +1할지
                var list = [1, -1];
                var randomNum = Math.floor(Math.random() * 2);
                console.log(randomNum);

                // 원 안의 랜덤 좌표 구하기
                var newR = Math.floor(Math.random() * random) + random;
                var newX = beforeCoords.La - ((newR * 0.00001) * list[randomNum]);
                var newY = beforeCoords.Ma - ((newR * 0.00001) * list[randomNum]);
                var afterCoords = new kakao.maps.LatLng(newY, newX);

                // 클릭한 위치를 기준으로 선을 생성하고 지도위에 표시합니다
                clickLine = new kakao.maps.Polyline({
                    map: map, // 선을 표시할 지도입니다
                    path: [beforeCoords, afterCoords], // 선을 구성하는 좌표 배열입니다 클릭한 위치를 넣어줍니다
                    strokeWeight: 0, // 선의 두께입니다
                    strokeColor: '#db4040', // 선의 색깔입니다
                    strokeOpacity: 0, // 선의 불투명도입니다 0에서 1 사이값이며 0에 가까울수록 투명합니다
                    strokeStyle: 'solid' // 선의 스타일입니다
                });

                var distance = Math.round(clickLine.getLength());
                console.log('distance : ', distance);
                console.log('newR : ', newR);
                var radius = random + distance;
                console.log('radius : ', radius);
                var circle = new kakao.maps.Circle({
                    center: afterCoords,  // 원의 중심좌표 입니다
                    radius: radius, // 미터 단위의 원의 반지름입니다
                    strokeWeight: 3, // 선의 두께입니다
                    strokeColor: '#3982FF', // 선의 색깔입니다
                    strokeOpacity: 1, // 선의 불투명도 입니다 1에서 0 사이의 값이며 0에 가까울수록 투명합니다
                    strokeStyle: 'dashed', // 선의 스타일 입니다
                    fillColor: '#CFE7FF', // 채우기 색깔입니다
                    fillOpacity: 0.7  // 채우기 불투명도 입니다
                });

                if (radius < 150) {
                    map.setLevel(3);
                }else if (radius > 300){
                    map.setLevel(5);
                }

                circle.setMap(map);
                map.setCenter(afterCoords);
            }
        });


        // house remove button event
        $("#removeBtn").click(function () {
            form.attr("action", "/house/remove").attr("method", "post");

            Swal.fire({
                title: '글을 삭제하시겠습니까?',
                text: "삭제하시면 다시 복수시킬 수 없습니다.",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: '삭제',
                cancelButtonText: '취소',
                timer: 10000,
                delay: 10000
            }).then((result) => {
                if (result.isConfirmed) {
                    form.submit();
                }
            })
        }); // end removeBtn event


        // file show
        $(".uploadResult li").click(function () {
            var file = $(this).data("file");

            console.log("image file click");
            console.log(file);

            $(".imageModal .modal-body").html("<img style='width:100%' src='/display?fileName=" + file + "&size=1'>");
            $(".imageModal").modal("show");
        });


        // star rating
        $('.starrr').starrr({
            rating: grade,
            change: function (e, value) {
                if (value) {
                    console.log(value);
                    grade = value;
                }
            }
            // readOnly: true
        });


        $(".addReviewBtn").click(function () {
            //inputId.val("");
            //inputContent.val("");

            $(".reviewRemoveBtn, .reviewModifyBtn").hide();
            $(".reviewSaveBtn").show();

            reviewModal.show();
        })


        // review register event
        $(".reviewSaveBtn").click(function (e) {
            var data = {
                houseNum: houseNum,
                grade: grade,
                content: inputContent.val(),
                reviewerId: inputId.val(),
                targetId: targetId
            };

            console.log("reivew save : " + data);

            $.ajax({
                url: '/review/' + houseNum,
                type: "POST",
                data: JSON.stringify(data),
                contentType: "application/json; charset=utf-8",
                dataType: "text",
                success: function (result) {
                    console.log("result: " + result);
                    self.location.reload();
                }
            });
        });


        // review
        function getHouseReviews() {

            function formatTime(str) {
                var date = new Date(str);
                return date.getFullYear() + '/' + (date.getMonth() + 1) + '/' + date.getDate() + ' ' + date.getHours() + ':' + date.getMinutes();
            }

            $.getJSON("/review/" + houseNum + "/all", function (arr) {
                var str = "";

                $.each(arr, function (idx, review) {
                    console.log(review);

                    str += '<div class="card-body" data-reviewNum=' + review.reviewNum + ' data-reviewerId=' + review.reviewerId + ' style="padding-left: 0px; padding-bottom: 10px">';
                    str += '<h6 class="card-title">' + review.content + '<div class"star-rating" data-rating="' + review.grade + '"></div><span>' + review.grade + '</div></span></h6>';
                    str += '<h7 class="card-subtitle mb-2 text-muted">' + review.nickName + '</h7>';
                    str += '<p class="card-text">' + formatTime(review.regDate) + '</p></div>';

                    /* 리뷰 조회 - 별점 보이게 수정하기
                    $('.star-rating').starrr({
                        rating : review.grade,
                    });*/
                });
                $(".reviewList").html(str);
            });
        }


        // review modify
        $(".reviewList").on("click", ".card-body", function () {

            $(".reviewSaveBtn").hide();
            $(".reviewRemoveBtn", ".reviewModifyBtn").show();

            var targetReview = $(this);

            console.log(targetReview);

            reviewNum = targetReview.data("reviewnum");
            console.log("reviewNum : " + reviewNum);
            inputId.val(targetReview.data("reviewerid"));
            inputContent.val(targetReview.find('.card-title').clone().children().remove().end().text());

            var grade = targetReview.find('.card-title span').html();
            console.log(grade);
            $(".starrr a:nth-child(" + grade + ")").trigger('click');
            $(".reviewModal").modal('show');

        });


        $(".reviewModifyBtn").on("click", function () {
            var data = {
                reviewNum: reviewNum,
                houseNum: houseNum,
                grade: grade,
                content: inputContent.val(),
                reviewerId: inputId.val(),
                targetId: targetId
            };

            console.log(data);

            $.ajax({
                url: '/review/' + houseNum + "/" + reviewNum,
                type: "PUT",
                data: JSON.stringify(data),
                contentType: "application/json; charset=utf-8",
                dataType: "text",
                success: function (result) {
                    console.log("result: " + result);
                    self.location.reload();
                }
            });
            reviewModal.modal("hide");
        });


        $(".reviewRemoveBtn").on("click", function () {

            var data = {reviewNum: reviewNum};

            console.log(data);

            $.ajax({
                url: '/review/' + houseNum + "/" + reviewNum,
                type: "DELETE",
                data: JSON.stringify(data),
                contentType: "application/json; charset=utf-8",
                dataType: "text",
                success: function (result) {
                    console.log("result: " + result);
                    self.location.reload();
                }
            });
            reviewModal.modal("hide");
        });


        function getWishCountByHouse() {
            $.getJSON("/wish/" + houseNum + "/all", function (count) {
                console.log("get wish count : " + count);
                $(".wishCount").html(count);
            });
        }

        function getHouseWishOfMember() {
            var id = "user100"; // 임시 아이디
            $.getJSON("/wish/" + houseNum + "/" + id, function (arr) {
                console.log("get house wish member : " + houseNum + ", " + id);
                if (arr != null) {
                    $(".wishIcon").data("current", "red");
                    $(".wishIcon").attr("src", "/images/icons/heart_red.png");
                }
            });
        }


        $(".wishIcon").on("click", function (e) {

            var icon = $(this);
            var current = icon.data("current");
            var id = "user100"; // 임시 아이디
            var data = {
                houseNum: houseNum,
                id: id
            };

            if (current == "black") {
                // wish save
                console.log("wish !!!!! houseNum : " + houseNum + ", id : " + id);
                icon.data("current", "red");
                icon.attr("src", "/images/icons/heart_red.png");

                $.ajax({
                    url: '/wish/' + houseNum,
                    type: "POST",
                    data: JSON.stringify(data),
                    contentType: "application/json; charset=utf-8",
                    dataType: "text",
                    success: function (result) {
                        console.log("result: " + result);
                        getWishCountByHouse();
                    }
                }); // end ajax
            } else {
                // wish delete
                console.log("do not wish !!!!! houseNum : " + houseNum + ", id : " + id);
                icon.data("current", "black");
                icon.attr("src", "/images/icons/heart_black.png");

                $.ajax({
                    url: '/wish/' + houseNum + "/" + id,
                    type: "DELETE",
                    data: JSON.stringify(data),
                    contentType: "application/json; charset=utf-8",
                    dataType: "text",
                    success: function (result) {
                        console.log("result: " + result);
                        getWishCountByHouse();
                    }
                }); // end ajax
            } // end else

        });

        getHouseReviews();
        getWishCountByHouse();
        getHouseWishOfMember();
    });
</script>